<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>QWES TV.id SUPREME</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        :root { --accent: #00f2fe; --red: #ff3b30; --green: #4cd964; }
        body, html { margin:0; padding:0; width:100%; height:100%; background:#000; color:white; overflow:hidden; font-family: 'Segoe UI', sans-serif; }
        
        /* NO SIGNAL LAYER - CUSTOM TEXT */
        #no-signal { 
            position:fixed; inset:0; background:#000; z-index:900000; display:none; 
            flex-direction:column; align-items:center; justify-content:center;
        }
        .semut { position:absolute; inset:0; opacity:0.1; background:url('https://media.giphy.com/media/oEI9uWUicG58Y/giphy.gif'); pointer-events:none; }

        /* DYNAMIC ISLAND NOTIF (v17 Style) */
        #island { 
            position:fixed; top:-120px; left:50%; transform:translateX(-50%); 
            width:420px; background:rgba(20,20,20,0.95); backdrop-filter:blur(10px);
            padding:20px; border-radius:30px; border:1px solid var(--accent); 
            z-index:1000000; transition:0.6s cubic-bezier(0.18, 0.89, 0.32, 1.28);
            display:flex; flex-direction:column; align-items:center; gap:15px;
        }
        #island.show { top:20px; }
        .btn-row { display:flex; gap:10px; width:100%; }
        .btn-notif { flex:1; padding:10px; border:none; border-radius:15px; font-weight:bold; cursor:pointer; }

        /* UI HOME (BALIK KE FITUR v17) */
        #home { height:100vh; display:flex; flex-direction:column; align-items:center; justify-content:center; }
        #big-clock { font-size: 9rem; font-weight: 100; margin:0; letter-spacing:-5px; }
        
        .app-grid { display:grid; grid-template-columns:repeat(5, 1fr); gap:25px; margin-top:30px; }
        .app { cursor:pointer; text-align:center; transition:0.3s; }
        .app:hover { transform:scale(1.1); }
        .icon-box { 
            width:85px; height:85px; border-radius:22px; background:#1a1a1a; 
            display:flex; align-items:center; justify-content:center; font-size:30px; 
            margin-bottom:8px; border:1px solid #333; box-shadow: 0 10px 20px rgba(0,0,0,0.5);
        }

        /* WEB VIEW LAYER */
        #web-ui { position:fixed; inset:0; background:#000; z-index:950000; display:none; }
        iframe { width:100%; height:100%; border:none; }
    </style>
</head>
<body onclick="document.documentElement.requestFullscreen()">

    <div id="no-signal">
        <div class="semut"></div>
        <h1 style="z-index:1; letter-spacing:5px; color:#555;">TIDAK ADA LAYANAN OS</h1>
        <p style="z-index:1; color:#333;">Silahkan hubungi administrator Center</p>
    </div>

    <div id="island">
        <b id="notif-title" style="color:var(--accent)">PEMBARUAN QWES TERSEDIA</b>
        <span id="notif-desc">Apakah Anda ingin menginstal kode baru sekarang?</span>
        <div class="btn-row">
            <button class="btn-notif" style="background:var(--green); color:#000;" onclick="applyUpdate(true)">TERIMA (INSTAL)</button>
            <button class="btn-notif" style="background:#333; color:#fff;" onclick="applyUpdate(false)">TOLAK</button>
        </div>
    </div>

    <div id="home">
        <div style="opacity:0.4; letter-spacing:8px; margin-bottom:10px;">QWES TV.id</div>
        <h1 id="big-clock">00:00</h1>
        
        <div class="app-grid">
            <div class="app" onclick="openApp('https://m.youtube.com')"><div class="icon-box" style="border-color:#f00; color:#f00;">YT</div><span>YouTube</span></div>
            <div class="app" onclick="openApp('https://m.tiktok.com')"><div class="icon-box" style="border-color:#fff;">TK</div><span>TikTok</span></div>
            <div class="app" onclick="alert('Branding: QWES TV v21\nStatus: Supreme')"><div class="icon-box" style="background:var(--accent); color:#000;">Q</div><span>Mesin</span></div>
            <div class="app" onclick="openApp('https://www.google.com')"><div class="icon-box" style="border-color:#4285F4; color:#4285F4;">G</div><span>Google</span></div>
            <div class="app" onclick="openApp('https://m.facebook.com')"><div class="icon-box" style="border-color:#1877F2; color:#1877F2;">FB</div><span>Facebook</span></div>
        </div>
    </div>

    <div id="web-ui">
        <iframe id="frame"></iframe>
        <button onclick="closeApp()" style="position:fixed; bottom:30px; left:50%; transform:translateX(-50%); padding:15px 40px; border-radius:50px; background:var(--red); color:white; border:none; font-weight:bold; cursor:pointer; box-shadow:0 0 20px rgba(255,0,0,0.5);">KELUAR</button>
    </div>

    <script>
        // CONFIG FIREBASE BOS
        const firebaseConfig = {
            apiKey: "AIzaSyBoS3INezO0UQptcXYNZFbnPbmmf_hU8xc",
            databaseURL: "https://xbook-global26-default-rtdb.asia-southeast1.firebasedatabase.app"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database().ref('qwes_tv_control');

        let incomingCode = "";

        // LISTEN DATABASE
        db.on('value', (snapshot) => {
            const data = snapshot.val();
            if(!data) return;

            // Fitur No Signal (Layanan OS)
            document.getElementById('no-signal').style.display = (data.signal === 'OFF') ? 'flex' : 'none';

            // Fitur Update dengan Notifikasi Terima/Tolak
            if(data.updateCode && data.updateCode !== "") {
                incomingCode = data.updateCode;
                document.getElementById('island').classList.add('show');
            }
        });

        function applyUpdate(confirm) {
            document.getElementById('island').classList.remove('show');
            if(confirm) {
                document.body.innerHTML = "<div style='display:flex;height:100vh;align-items:center;justify-content:center;background:#000;flex-direction:column;'><h1>MENGINSTAL PEMBARUAN...</h1><p>QWES TV akan booting ulang</p></div>";
                db.update({ updateCode: "" }); // Clear database
                setTimeout(() => {
                    document.open();
                    document.write(incomingCode);
                    document.close();
                }, 2000);
            } else {
                db.update({ updateCode: "" }); // Abaikan update
            }
        }

        // Fitur Jam v17
        setInterval(() => {
            let d = new Date();
            document.getElementById('big-clock').innerText = d.getHours().toString().padStart(2,'0')+":"+d.getMinutes().toString().padStart(2,'0');
        }, 1000);

        function openApp(url) { document.getElementById('frame').src = url; document.getElementById('web-ui').style.display = 'block'; }
        function closeApp() { document.getElementById('web-ui').style.display = 'none'; document.getElementById('frame').src = ''; }
    </script>
</body>
</html>
