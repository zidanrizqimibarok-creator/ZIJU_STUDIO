<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>QWES TV v26 SUPREME</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        :root { --accent: #00f2fe; --red: #ff3b30; --green: #4cd964; }
        body, html { margin:0; padding:0; width:100%; height:100%; background:#000; color:white; overflow:hidden; font-family: 'Segoe UI', sans-serif; }
        
        /* LAYAR BOOTING */
        #boot { position:fixed; inset:0; background:#000; z-index:9999999; display:flex; flex-direction:column; align-items:center; justify-content:center; transition:1s; }
        .logo { font-size:3rem; font-weight:bold; letter-spacing:15px; text-shadow:0 0 20px var(--accent); animation:pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity:0.3; transform:scale(0.95); } 50% { opacity:1; transform:scale(1); } }

        /* BRIGHTNESS LAYER */
        #br-layer { position:fixed; inset:0; background:black; opacity:0; pointer-events:none; z-index:9999998; }

        /* DYNAMIC ISLAND */
        #island { 
            position:fixed; top:-150px; left:50%; transform:translateX(-50%); 
            width:400px; background:rgba(20,20,20,0.9); backdrop-filter:blur(15px);
            padding:20px; border-radius:30px; border:1px solid var(--accent); 
            z-index:1000000; transition:0.6s cubic-bezier(0.18, 0.89, 0.32, 1.28);
            text-align:center;
        }
        #island.show { top:20px; }

        /* NO SERVICE */
        #no-service { position:fixed; inset:0; background:#000; z-index:900000; display:none; flex-direction:column; align-items:center; justify-content:center; }

        /* UI UTAMA */
        #home { height:100vh; display:flex; flex-direction:column; align-items:center; justify-content:center; }
        #clock { font-size:9rem; font-weight:100; margin:0; }
        .app-grid { display:grid; grid-template-columns:repeat(5, 1fr); gap:20px; margin-top:30px; }
        .app { cursor:pointer; text-align:center; transition:0.3s; }
        .app:hover { transform:scale(1.1); }
        .icon { width:80px; height:80px; border-radius:22px; background:#111; border:1px solid #333; display:flex; align-items:center; justify-content:center; font-size:30px; margin-bottom:5px; }

        /* APP VIEW */
        #web-ui { position:fixed; inset:0; background:#000; z-index:950000; display:none; }
        iframe { width:100%; height:100%; border:none; }
        .exit-btn { position:fixed; bottom:30px; left:50%; transform:translateX(-50%); padding:15px 40px; border-radius:50px; background:var(--red); color:white; border:none; font-weight:bold; cursor:pointer; }
    </style>
</head>
<body onload="startOS()">

    <div id="br-layer"></div>

    <div id="boot">
        <div class="logo">QWES TV</div>
        <p id="status">MEMUAT SISTEM...</p>
    </div>

    <div id="no-service">
        <h1 style="letter-spacing:5px; color:#444;">TIDAK ADA LAYANAN OS</h1>
    </div>

    <div id="island">
        <b style="color:var(--accent)">UPDATE QWES TERSEDIA</b><br>
        <span>Instal pembaruan sistem sekarang?</span><br><br>
        <button onclick="applyUpdate(true)" style="background:var(--accent); border:none; padding:10px 20px; border-radius:10px; font-weight:bold; cursor:pointer;">TERIMA</button>
        <button onclick="applyUpdate(false)" style="background:#333; color:white; border:none; padding:10px 20px; border-radius:10px; cursor:pointer;">ABAIKAN</button>
    </div>

    <div id="home">
        <div style="opacity:0.3; letter-spacing:10px; margin-bottom:10px;">QWES TV.id v26</div>
        <h1 id="clock">00:00</h1>
        <div class="app-grid">
            <div class="app" onclick="openApp('https://m.youtube.com')"><div class="icon" style="color:red">YT</div><span>YouTube</span></div>
            <div class="app" onclick="showInfo()"><div class="icon" style="color:var(--accent)">‚ÑπÔ∏è</div><span>Info</span></div>
            <div class="app" onclick="alert('Store Segera Hadir!')"><div class="icon" style="color:orange">üõí</div><span>Store</span></div>
            <div class="app" onclick="openApp('https://m.tiktok.com')"><div class="icon">TK</div><span>TikTok</span></div>
            <div class="app" onclick="openApp('https://www.google.com')"><div class="icon">G</div><span>Browser</span></div>
        </div>
    </div>

    <div id="web-ui">
        <iframe id="frame"></iframe>
        <button class="exit-btn" onclick="closeApp()">KELUAR PINTASAN</button>
    </div>

    <script>
        // KODE SINKRON KE FIREBASE BOS
        const config = {
            apiKey: "AIzaSyBoS3INezO0UQptcXYNZFbnPbmmf_hU8xc",
            databaseURL: "https://xbook-global26-default-rtdb.asia-southeast1.firebasedatabase.app"
        };
        firebase.initializeApp(config);
        const db = firebase.database().ref('qwes_tv_control');

        let incomingCode = "";

        function startOS() {
            // Paksa Fullscreen
            document.documentElement.requestFullscreen().catch(() => {});

            // Pantau Firebase
            db.on('value', (snap) => {
                const data = snap.val();
                if(!data) return;

                // 1. Kontrol Layanan (OFF/ON)
                document.getElementById('no-service').style.display = (data.signal === 'OFF') ? 'flex' : 'none';
                
                // 2. Kontrol Brightness
                if(data.brightness !== undefined) {
                    document.getElementById('br-layer').style.opacity = 1 - data.brightness;
                }

                // 3. Kontrol Update
                if(data.updateCode && data.updateCode !== "") {
                    incomingCode = data.updateCode;
                    document.getElementById('island').classList.add('show');
                }
            });

            // Jam
            setInterval(() => {
                let d = new Date();
                document.getElementById('clock').innerText = d.getHours().toString().padStart(2,'0')+":"+d.getMinutes().toString().padStart(2,'0');
            }, 1000);

            // Hilangkan Layar Boot
            setTimeout(() => {
                document.getElementById('boot').style.opacity = '0';
                setTimeout(() => document.getElementById('boot').style.display = 'none', 1000);
            }, 3000);
        }

        function applyUpdate(confirm) {
            document.getElementById('island').classList.remove('show');
            if(confirm) {
                // Bersihkan LocalStorage biar gak penuh, lalu isi yang baru
                localStorage.clear();
                localStorage.setItem('qwes_saved_os', incomingCode);
                db.update({ updateCode: "" });
                
                document.body.innerHTML = "<div style='display:flex;height:100vh;align-items:center;justify-content:center;background:#000'><h1>MENGINSTAL & REBOOT...</h1></div>";
                setTimeout(() => { location.reload(); }, 2000);
            } else {
                db.update({ updateCode: "" });
            }
        }

        // SISTEM PERMANEN: Cek Memori Internal
        const saved = localStorage.getItem('qwes_saved_os');
        if(saved && !window.osLoaded) {
            window.osLoaded = true;
            document.open();
            document.write(saved);
            document.close();
        }

        function showInfo() {
            alert("QWES TV v26 Supreme\nRAM: 2GB (Polytron Optimized)\nSistem: Permanen LocalStorage\nUpdate: Konfirmasi Dinamis\nStatus: Terhubung ke xbook-global26");
        }

        function openApp(url) {
            document.getElementById('frame').src = url;
            document.getElementById('web-ui').style.display = 'block';
            document.documentElement.requestFullscreen();
        }

        function closeApp() {
            document.getElementById('web-ui').style.display = 'none';
            document.getElementById('frame').src = '';
        }
    </script>
</body>
</html>
